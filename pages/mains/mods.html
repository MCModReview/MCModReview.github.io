<!DOCTYPE HTML>
<html>
    <head>
        <base href="/">
    </head>
    
    <body style="padding-top: 20vh;">
        <p style="color: white;">Hello there! (mods page)</p>
        <button onclick="loadPostMetadata('/pages/posts/file_index.json')">Test</button>
        <div id="mods-container" class="mods-grid"></div>
    </body>
    <script>
    async function loadLatestPosts() {
  const container = document.getElementById('mods-container');
  if (!container) {
    console.error('#mods-container not found');
    return;
  }
  container.innerHTML = '';

  // STEP 1: Load the index of HTML files
  let postFiles;
  try {
    const response = await fetch('/pages/posts/file_index.json');  // ← JSON, not HTML
    if (!response.ok) throw new Error('Failed to load index');
    postFiles = await response.json(); // ← array of HTML file paths
  } catch (err) {
    console.error(err);
    return;
  }

  // STEP 2: Load metadata for each HTML file
  const fragment = document.createDocumentFragment();
  let row = null;

  for (let i = 0; i < postFiles.length; i++) {
    const filePath = postFiles[i]; // this is a path to a .html
    const meta = await loadPostMetadata(filePath);
    if (!meta) continue;

    if (i % 3 === 0) {
      row = document.createElement('div');
      row.className = 'card-row';
      fragment.appendChild(row);
    }

    const card = document.createElement('div');
    card.className = 'card obj_round_corner';
    card.innerHTML = `
      <img src="${meta.image}" alt="${meta.title}"
           style="width:${meta.imageWidth}; height:${meta.imageHeight};">
      <div class="container">
        <h4><b>${meta.title}</b></h4>
        <p>${meta.excerpt}</p>
      </div>
    `;
    row.appendChild(card);
  }

  container.appendChild(fragment);
}
</script>
</html>